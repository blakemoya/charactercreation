# Character Creation
An exploratory face tuning program built to investigate the face space generated by [OpenFace's](https://github.com/cmusatyalab/openface) nn4.small2.v1.
The program, when socketed in to a dataset similar in construction to [VGGFace2](http://www.robots.ox.ac.uk/~vgg/data/vgg_face2/) and a spreadsheet of some of those faces openface 128-value representations, will use [Satya Mallick's OpenCV face averaging algorithm](https://www.learnopencv.com/average-face-opencv-c-python-tutorial/) to display an interpolated face that might appear at a user-determined location in the face space.

This program was built as an extension of a paper I wrote showing that the high dimensional organization of neural network learned face spaces (specifically, this one) is perceptible by humans. That paper is contianed in this repository.

## Getting Started
### Prerequisites
- numpy
- pandas
- scipy
- dlib
- opencv
- matplotlib
- openface (optional)

### Usage

#### Downloads

Clone this repo with 

`git clone https://github.com/blakemoya/charactercreation`

Unfortunately, this program works off of a local copy of VGGFace2, which can be downloaded [here](http://www.robots.ox.ac.uk/~vgg/data/vgg_face2/data_infor.html) but is incredibly large. Beware.

#### Configuration

In the character_creation.py main call, there a five configuration variables to set.
1. CSV_PATH: this string should be the path to thge csv file where you are storing the openface calculated representations of the faces to be included in the interpolation.
2. VGG_TRAIN_PATH: this string should be the path where you are storing the VGGFace2 "train" folder (or similarly constructed dataset).
3. NUM_NEIGHBORS: this integer sets the number of nearest neighbors to be included in the image interpolation.
4. EXAG_FACTOR: this integer is similar to a weighting of how much more closer faces should matter in the summation as images are averaged.
5. NUM_IMAGES: this integer sets the number of images to be averaged in each interpolation.

#### Instructions

Once configuration variables are set, run character_creation.py

A panel of the 128 measurements utilized by nn4.small2.v1 appears on the left side of the window, with a viewing panel on the right and a navigation slider at the bottom.

Click on the button with the axis you intend to move on and left click and drage the slider to manipulate that axis' value, or left click to instantly change it.

As you move each slider, that variables value will be reset, and then the active location of the interpolation will be projected back down onto nn4.small2.v1's output space before the inteprolation is generated.

### Demo

<p align="center">
  <img src="https://imgur.com/gkLoIsC.gif" width="640" height="536">
</p>
